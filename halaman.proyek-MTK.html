<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tugas Statistik Modern - 3 Siswa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- Menambahkan Font Awesome untuk Ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');

        /* ----- Variabel Palet Warna Modern ----- */
        :root {
            --bg-start: #1f2937;
            --bg-end: #111827;
            --card-bg: rgba(255, 255, 255, 0.05);
            --border-color: rgba(255, 255, 255, 0.1);
            --text-primary: #f3f4f6;
            --text-secondary: #9ca3af;
            --accent-color: #6366f1;
            --accent-hover: #8183f7;
            --glow-color: rgba(99, 102, 241, 0.5);
        }

        /* ----- Gaya Dasar & Latar Belakang Animasi ----- */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(225deg, var(--bg-start), #312e81, var(--bg-end));
            background-size: 400% 400%;
            animation: gradient-animation 20s ease infinite;
            color: var(--text-primary);
            overflow-x: hidden;
        }
        
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* ----- Kontainer Utama dengan Efek Kaca (Glassmorphism) ----- */
        .container {
            max-width: 800px;
            margin: 3rem auto;
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: box-shadow 0.4s ease, border-color 0.4s ease;
        }
        .container:hover {
            border-color: var(--glow-color);
            box-shadow: 0 0 40px rgba(99, 102, 241, 0.2), 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* ----- Navigasi Tab ----- */
        .tabs-nav {
            display: flex;
            gap: 0.5rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }
        .tab-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: 500;
            border-radius: 0.5rem 0.5rem 0 0;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
            position: relative;
        }
        .tab-btn.active {
            color: var(--text-primary);
            background: var(--card-bg);
            border-bottom: 2px solid var(--accent-color);
            box-shadow: 0 2px 15px -5px var(--glow-color);
        }
        .tab-btn:hover:not(.active) {
            background: rgba(255,255,255,0.03);
            color: var(--text-primary);
        }

        /* ----- Konten Halaman/Tab ----- */
        .page-content {
            display: none; /* Sembunyikan semua halaman secara default */
        }
        .page-content.active {
            display: block; /* Tampilkan hanya halaman yang aktif */
            animation: fadeInPage 0.6s ease-out;
        }
        
        @keyframes fadeInPage {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ----- Tipografi dan Judul ----- */
        .section-title {
            color: var(--text-primary);
            border-bottom: 2px solid var(--border-color);
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        p { color: var(--text-secondary); }
        th, td { border: 1px solid var(--border-color); padding: 0.75rem; text-align: left; }
        th { background-color: rgba(255, 255, 255, 0.1); font-weight: 600; }
        
        /* ----- Animasi & Efek Tabel Data Mentah ----- */
        .data-table tr {
            transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .data-table tr:hover {
            transform: translateY(-4px) scale(1.02);
            background-color: rgba(99, 102, 241, 0.15);
            box-shadow: 0 8px 24px rgba(0,0,0,0.4);
            z-index: 10;
            position: relative;
        }
        @keyframes slideUpFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-card-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 1rem; }
        .stat-card { background: var(--card-bg); padding: 1.5rem; border-radius: 1rem; border: 1px solid var(--border-color); transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease; opacity: 0; animation: fadeInUp 0.5s ease-out forwards; }
        .stat-card:hover { transform: translateY(-8px); box-shadow: 0 0 20px var(--glow-color); border-color: var(--accent-hover); }
        .grid .stat-card:nth-child(2) { animation-delay: 0.1s; }
        .grid .stat-card:nth-child(3) { animation-delay: 0.2s; }
        
        .stat-card h3, .stat-card h4 { color: var(--text-primary); font-weight: 600; }
        .stat-card p { color: var(--accent-hover); font-size: 1.2rem; font-weight: 700; }
        .stat-card i { transition: transform 0.3s ease, color 0.3s ease; }
        .stat-card:hover i { transform: scale(1.1); color: var(--accent-hover) !important; }

        .chart-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(0,0,0,0.2);
            padding: 1.5rem;
            border-radius: 1rem;
            position: relative; /* Diperlukan untuk label diagram batang */
            transition: transform 0.3s ease, box-shadow 0.3s ease, border 0.3s ease;
            border: 1px solid transparent;
        }
        .chart-container:hover {
            transform: scale(1.05);
            border: 1px solid var(--glow-color);
            box-shadow: 0 0 25px rgba(99, 102, 241, 0.2);
        }
        .chart-title { text-align: center; font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: var(--text-secondary); }
        
        /* ----- Gaya Legenda Diagram ----- */
        .chart-legend {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem; /* 14px */
            color: var(--text-secondary);
        }
        .legend-color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* ----- Analisis Interaktif ----- */
        .analysis-text { 
            background-color: rgba(0,0,0,0.2); 
            padding: 1rem; 
            border-radius: 0.5rem; 
            margin-top: 1rem; 
            border-left: 4px solid var(--accent-color);
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .analysis-text:hover {
            background-color: rgba(0,0,0,0.3);
        }
        .summary-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, margin-top 0.5s ease-out, padding-top 0.5s ease-out;
        }
        .summary-content.show {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
            max-height: 200px;
        }
        .click-prompt {
            transition: opacity 0.3s ease;
        }

        @keyframes text-flip { from { transform: translateY(0) scale(1); opacity: 1; } 49% { transform: translateY(10px) scale(0.95); opacity: 0; } 50% { transform: translateY(-10px) scale(0.95); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }
        .text-flipping { animation: text-flip 0.5s ease-in-out; }

    </style>
</head>
<body class="p-4">

    <div class="container">
        <!-- Navigasi Tab untuk Siswa -->
        <nav class="tabs-nav">
            <button class="tab-btn active" onclick="showPage('page-ahmad')">Ahmad S. Khoil</button>
            <button class="tab-btn" onclick="showPage('page-dawi')">Dawi Khumaeroh</button>
            <button class="tab-btn" onclick="showPage('page-fasa')">Fasa A. Ninjat</button>
        </nav>

        <!-- ======================================================= -->
        <!-- KONTEN HALAMAN 1: AHMAD S. KHOIL -->
        <!-- ======================================================= -->
        <div id="page-ahmad" class="page-content active">
             <!-- Header -->
            <header class="mb-12">
                <div class="text-left mb-8">
                    <div><p class="text-sm text-secondary">Nama</p><p class="font-semibold text-primary">Ahmad Sabilul Khoil</p></div>
                    <div class="mt-2"><p class="text-sm text-secondary">No. Absen</p><p class="font-semibold text-primary">02</p></div>
                    <div class="mt-2"><p class="text-sm text-secondary">Kelas</p><p class="font-semibold text-primary">XI TJK 2</p></div>
                </div>
                <div class="text-center">
                    <h1 class="text-4xl font-bold">Tugas Statistik Pribadi</h1>
                    <p class="text-gray-400 mt-2">Analisis Data Aktivitas Mingguan</p>
                </div>
            </header>
            
            <!-- Data & Analisis -->
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Kolom Kiri: Tabel & Perhitungan -->
                <div>
                    <h3 class="text-xl font-medium mb-4">Data Mentah</h3>
                    <div class="space-y-6">
                        <div>
                            <h4>Hobi (Jenis & Frekuensi)</h4>
                            <table class="w-full mt-2 data-table"><thead><tr><th>Jenis Hobi</th><th>Frekuensi</th></tr></thead><tbody id="hobi-table-ahmad"></tbody></table>
                        </div>
                        <div>
                            <h4>Aktivitas Rutin</h4>
                            <table class="w-full mt-2 data-table"><thead><tr><th>Aktivitas</th><th>Frekuensi</th></tr></thead><tbody id="aktivitas-table-ahmad"></tbody></table>
                        </div>
                    </div>

                    <h3 class="text-xl font-medium mb-4 mt-8">Perhitungan Sederhana</h3>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="stat-card p-4"><i class="fa-solid fa-calculator text-2xl text-green-400 mb-2"></i><h4>Rata-rata Aktivitas</h4><p id="avg-aktivitas-ahmad" class="text-base text-secondary mt-1"></p></div>
                        <div class="stat-card p-4"><i class="fa-solid fa-star text-2xl text-yellow-400 mb-2"></i><h4>Hobi Populer</h4><p id="modus-hobi-ahmad" class="text-base text-secondary mt-1"></p></div>
                        <div class="stat-card p-4"><i class="fa-solid fa-chart-pie text-2xl text-blue-400 mb-2"></i><h4>% Akademik</h4><p id="persen-akademik-ahmad" class="text-base text-secondary mt-1"></p></div>
                    </div>

                    <h3 class="text-xl font-medium mb-4 mt-8">Prestasi</h3>
                     <div class="grid md:grid-cols-2 gap-4">
                        <div id="academic-card-ahmad" class="stat-card p-4 cursor-pointer">
                            <i class="fa-solid fa-graduation-cap text-2xl text-accent-color mb-2"></i><h4>Akademik (Klik)</h4>
                            <p id="academic-achievement-ahmad" class="text-base text-secondary mt-1 leading-snug">Ranking 1 di SMP</p>
                        </div>
                        <div class="stat-card p-4">
                            <i class="fa-solid fa-trophy text-2xl text-yellow-400 mb-2"></i><h4>Non-Akademik</h4>
                            <p id="non-academic-achievement-ahmad" class="text-base text-secondary mt-1 leading-snug">Anggota Pelajar Penggerak Merah Putih</p>
                        </div>
                    </div>
                </div>
                <!-- Kolom Kanan: Grafik & Analisis -->
                <div>
                     <h3 class="text-xl font-medium mb-4">Visualisasi & Analisis</h3>
                     <div class="space-y-6">
                        <div class="chart-container">
                            <h3 class="chart-title">Hobi</h3>
                            <div id="pie-chart-ahmad"></div>
                            <div id="pie-legend-ahmad" class="chart-legend"></div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">Aktivitas</h3>
                            <div id="bar-chart-ahmad"></div>
                            <div id="bar-legend-ahmad" class="chart-legend"></div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">Nilai Akademik</h3>
                            <div id="prestasi-chart-ahmad"></div>
                        </div>
                    </div>
                    <div id="analysis-container-ahmad" class="analysis-text mt-6">
                        <p><strong>Analisis Sabil:</strong> Menunjukkan profil yang sangat seimbang antara akademis dan non-akademis. Hobinya didominasi oleh kegiatan fisik seperti bermain bola, yang didukung oleh rutinitas olahraga yang konsisten. Di sisi lain, komitmen belajarnya yang tinggi tercermin dari berbagai prestasi akademiknya.</p>
                        <div id="summary-ahmad" class="summary-content"></div>
                        <p id="prompt-ahmad" class="click-prompt mt-2 text-xs text-accent-color"><em>Klik untuk detail rangkuman...</em></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ======================================================= -->
        <!-- KONTEN HALAMAN 2: DAWI KHUMAEROH -->
        <!-- ======================================================= -->
        <div id="page-dawi" class="page-content">
            <!-- Header -->
            <header class="mb-12">
                <div class="text-left mb-8">
                    <div><p class="text-sm text-secondary">Nama</p><p class="font-semibold text-primary">Dawi Khumaeroh</p></div>
                    <div class="mt-2"><p class="text-sm text-secondary">No. Absen</p><p class="font-semibold text-primary">05</p></div>
                    <div class="mt-2"><p class="text-sm text-secondary">Kelas</p><p class="font-semibold text-primary">XI TJK 2</p></div>
                </div>
                <div class="text-center">
                    <h1 class="text-4xl font-bold">Tugas Statistik Pribadi</h1>
                    <p class="text-gray-400 mt-2">Analisis Data Aktivitas Mingguan</p>
                </div>
            </header>

             <!-- Data & Analisis -->
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Kolom Kiri: Tabel & Perhitungan -->
                <div>
                    <h3 class="text-xl font-medium mb-4">Data Mentah</h3>
                    <div class="space-y-6">
                        <div>
                            <h4>Hobi (Jenis & Frekuensi)</h4>
                            <table class="w-full mt-2 data-table"><thead><tr><th>Jenis Hobi</th><th>Frekuensi</th></tr></thead><tbody id="hobi-table-dawi"></tbody></table>
                        </div>
                        <div>
                            <h4>Aktivitas Rutin</h4>
                            <table class="w-full mt-2 data-table"><thead><tr><th>Aktivitas</th><th>Frekuensi</th></tr></thead><tbody id="aktivitas-table-dawi"></tbody></table>
                        </div>
                    </div>
                     <h3 class="text-xl font-medium mb-4 mt-8">Perhitungan Sederhana</h3>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="stat-card p-4"><i class="fa-solid fa-calculator text-2xl text-green-400 mb-2"></i><h4>Rata-rata Aktivitas</h4><p id="avg-aktivitas-dawi" class="text-base text-secondary mt-1"></p></div>
                        <div class="stat-card p-4"><i class="fa-solid fa-star text-2xl text-yellow-400 mb-2"></i><h4>Hobi Populer</h4><p id="modus-hobi-dawi" class="text-base text-secondary mt-1"></p></div>
                        <div class="stat-card p-4"><i class="fa-solid fa-chart-pie text-2xl text-blue-400 mb-2"></i><h4>% Akademik</h4><p id="persen-akademik-dawi" class="text-base text-secondary mt-1"></p></div>
                    </div>
                    <h3 class="text-xl font-medium mb-4 mt-8">Prestasi</h3>
                     <div class="grid md:grid-cols-2 gap-4">
                        <div id="academic-card-dawi" class="stat-card p-4 cursor-pointer">
                            <i class="fa-solid fa-graduation-cap text-2xl text-accent-color mb-2"></i><h4>Akademik (Klik)</h4>
                            <p id="academic-achievement-dawi" class="text-base text-secondary mt-1">Bahasa Arab nilai 88</p>
                        </div>
                        <div class="stat-card p-4">
                            <i class="fa-solid fa-trophy text-2xl text-yellow-400 mb-2"></i><h4>Non-Akademik</h4>
                            <p id="non-academic-achievement-dawi" class="text-base text-secondary mt-1">-</p>
                        </div>
                    </div>
                </div>
                <!-- Kolom Kanan: Grafik & Analisis -->
                <div>
                     <h3 class="text-xl font-medium mb-4">Visualisasi & Analisis</h3>
                     <div class="space-y-6">
                        <div class="chart-container">
                            <h3 class="chart-title">Hobi</h3>
                            <div id="pie-chart-dawi"></div>
                            <div id="pie-legend-dawi" class="chart-legend"></div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">Aktivitas</h3>
                            <div id="bar-chart-dawi"></div>
                            <div id="bar-legend-dawi" class="chart-legend"></div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">Nilai Akademik</h3>
                            <div id="prestasi-chart-dawi"></div>
                        </div>
                    </div>
                    <div id="analysis-container-dawi" class="analysis-text mt-6">
                        <p><strong>Analisis Dawi:</strong> Profilnya menunjukkan kecenderungan kuat pada hobi yang bersifat santai dan personal, seperti mendengarkan musik. Rutinitasnya didominasi oleh kegiatan pemenuhan kebutuhan dasar dengan frekuensi sangat tinggi, yang mengindikasikan pola hidup yang teratur. Prestasinya terfokus pada bidang akademik.</p>
                        <div id="summary-dawi" class="summary-content"></div>
                        <p id="prompt-dawi" class="click-prompt mt-2 text-xs text-accent-color"><em>Klik untuk detail rangkuman...</em></p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ======================================================= -->
        <!-- KONTEN HALAMAN 3: FASA AKHAMDIN NINJAT -->
        <!-- ======================================================= -->
        <div id="page-fasa" class="page-content">
            <!-- Header -->
            <header class="mb-12">
                <div class="text-left mb-8">
                    <div><p class="text-sm text-secondary">Nama</p><p class="font-semibold text-primary">Fasa Akhamdin Ninjat</p></div>
                    <div class="mt-2"><p class="text-sm text-secondary">No. Absen</p><p class="font-semibold text-primary">08</p></div>
                    <div class="mt-2"><p class="text-sm text-secondary">Kelas</p><p class="font-semibold text-primary">XI TJK 2</p></div>
                </div>
                <div class="text-center">
                    <h1 class="text-4xl font-bold">Tugas Statistik Pribadi</h1>
                    <p class="text-gray-400 mt-2">Analisis Data Aktivitas Mingguan</p>
                </div>
            </header>

            <!-- Data & Analisis -->
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Kolom Kiri: Tabel & Perhitungan -->
                <div>
                    <h3 class="text-xl font-medium mb-4">Data Mentah</h3>
                    <div class="space-y-6">
                        <div>
                            <h4>Hobi (Jenis & Frekuensi)</h4>
                            <table class="w-full mt-2 data-table"><thead><tr><th>Jenis Hobi</th><th>Frekuensi</th></tr></thead><tbody id="hobi-table-fasa"></tbody></table>
                        </div>
                        <div>
                            <h4>Aktivitas Rutin</h4>
                            <table class="w-full mt-2 data-table"><thead><tr><th>Aktivitas</th><th>Frekuensi</th></tr></thead><tbody id="aktivitas-table-fasa"></tbody></table>
                        </div>
                    </div>
                    <h3 class="text-xl font-medium mb-4 mt-8">Perhitungan Sederhana</h3>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="stat-card p-4"><i class="fa-solid fa-calculator text-2xl text-green-400 mb-2"></i><h4>Rata-rata Aktivitas</h4><p id="avg-aktivitas-fasa" class="text-base text-secondary mt-1"></p></div>
                        <div class="stat-card p-4"><i class="fa-solid fa-star text-2xl text-yellow-400 mb-2"></i><h4>Hobi Populer</h4><p id="modus-hobi-fasa" class="text-base text-secondary mt-1"></p></div>
                        <div class="stat-card p-4"><i class="fa-solid fa-chart-pie text-2xl text-blue-400 mb-2"></i><h4>% Akademik</h4><p id="persen-akademik-fasa" class="text-base text-secondary mt-1"></p></div>
                    </div>
                    <h3 class="text-xl font-medium mb-4 mt-8">Prestasi</h3>
                     <div class="grid md:grid-cols-2 gap-4">
                        <div id="academic-card-fasa" class="stat-card p-4 cursor-pointer">
                            <i class="fa-solid fa-graduation-cap text-2xl text-accent-color mb-2"></i><h4>Akademik (Klik)</h4>
                            <p id="academic-achievement-fasa" class="text-base text-secondary mt-1">Ranking 6</p>
                        </div>
                        <div class="stat-card p-4">
                             <i class="fa-solid fa-trophy text-2xl text-yellow-400 mb-2"></i><h4>Non-Akademik</h4>
                            <p id="non-academic-achievement-fasa" class="text-base text-secondary mt-1">-</p>
                        </div>
                    </div>
                </div>
                <!-- Kolom Kanan: Grafik & Analisis -->
                <div>
                     <h3 class="text-xl font-medium mb-4">Visualisasi & Analisis</h3>
                     <div class="space-y-6">
                        <div class="chart-container">
                            <h3 class="chart-title">Hobi</h3>
                            <div id="pie-chart-fasa"></div>
                            <div id="pie-legend-fasa" class="chart-legend"></div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">Aktivitas</h3>
                            <div id="bar-chart-fasa"></div>
                            <div id="bar-legend-fasa" class="chart-legend"></div>
                        </div>
                        <div class="chart-container">
                            <h3 class="chart-title">Nilai Akademik</h3>
                            <div id="prestasi-chart-fasa"></div>
                        </div>
                    </div>
                    <div id="analysis-container-fasa" class="analysis-text mt-6">
                        <p><strong>Analisis Fasa:</strong> Menunjukkan minat pada hobi yang bervariasi, mulai dari game hingga aktivitas fisik seperti voli. Rutinitas hariannya sangat didominasi oleh kegiatan dasar seperti makan dan mandi. Meskipun porsi waktu untuk belajar terlihat lebih sedikit, ia tetap mampu menunjukkan pencapaian akademis yang baik.</p>
                        <div id="summary-fasa" class="summary-content"></div>
                        <p id="prompt-fasa" class="click-prompt mt-2 text-xs text-accent-color"><em>Klik untuk detail rangkuman...</em></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Fungsi Navigasi Halaman ---
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            
            const targetPage = document.getElementById(pageId);
            if(targetPage) {
                targetPage.classList.add('active');
            }

            const targetButton = document.querySelector(`.tab-btn[onclick="showPage('${pageId}')"]`);
            if(targetButton) {
                targetButton.classList.add('active');
            }
        }

        // --- Data untuk 3 Siswa ---
        const dataAhmad = {
            hobi: [ { name: "Bermain Bola", value: 7 }, { name: "Bermain Basket", value: 3 }, { name: "Work Out", value: 5 } ],
            aktivitas: [ { name: "Olahraga Pagi", value: 7 }, { name: "Bersih Rumah", value: 7 }, { name: "Sekolah", value: 5 }, { name: "Gym", value: 2 }, { name: "Belajar", value: 7 } ],
            prestasiAkademik: [ "Ranking 1 di SMP", "Ranking 1 Kelas 10", "Ranking 4 Paralel SMP", "Nilai Sempurna Mapel Inggris", "Nilai Sempurna Mapel IPAS" ],
            nilaiAkademik: [ { name: "MTK", value: 100 }, { name: "B. Indo", value: 86 }, { name: "B. Ing", value: 100 }, { name: "PAI", value: 90 }, { name: "Sejarah", value: 86 } ],
            prestasiNonAkademik: ["Anggota Pelajar Penggerak Merah Putih"],
            prestasiIndex: 0,
            summaryGenerated: false
        };
        const dataDawi = {
            hobi: [ { name: "Main Game", value: 4 }, { name: "Membaca Buku", value: 3 }, { name: "Dengar Musik", value: 6 } ],
            aktivitas: [ { name: "Makan", value: 15 }, { name: "Minum", value: 15 }, { name: "Belajar", value: 7 }, { name: "Mandi", value: 14 } ],
            prestasiAkademik: [ "Ranking 6 Pararel di SMP", "Nilai 100 Matematika di SMP", "Bahasa Arab = 88" ],
            nilaiAkademik: [ { name: "MTK", value: 100 }, { name: "B. Arab", value: 95 }, { name: "B. Ing", value: 88 }, { name: "Fiqih", value: 86 }, { name: "Sejarah", value: 90 } ],
            prestasiNonAkademik: [],
            prestasiIndex: 0,
            summaryGenerated: false
        };
        const dataFasa = {
            hobi: [ { name: "Main Voli", value: 2 }, { name: "Game", value: 4 }, { name: "Memasak", value: 3 } ],
            aktivitas: [ { name: "Makan", value: 14 }, { name: "Minum", value: 8 }, { name: "Mandi", value: 14 }, { name: "Belajar", value: 5 } ],
            prestasiAkademik: [ "Ranking 6" ],
            nilaiAkademik: [ { name: "Kimia", value: 98 }, { name: "Seni Rupa", value: 94 }, { name: "Biologi", value: 90 } ],
            prestasiNonAkademik: [],
            prestasiIndex: 0,
            summaryGenerated: false
        };
        
        // --- Fungsi Perhitungan Statistik ---
        function calculateAndDisplayStats(data, ids) {
            const totalAktivitas = data.aktivitas.reduce((sum, item) => sum + item.value, 0);
            const avgAktivitas = totalAktivitas / data.aktivitas.length;
            document.getElementById(ids.avgAktivitas).textContent = `${avgAktivitas.toFixed(1)} / minggu`;

            const modusHobi = data.hobi.reduce((prev, current) => (prev.value > current.value) ? prev : current);
            document.getElementById(ids.modusHobi).textContent = modusHobi.name;

            const totalPrestasi = data.prestasiAkademik.length + data.prestasiNonAkademik.length;
            const persenAkademik = totalPrestasi > 0 ? (data.prestasiAkademik.length / totalPrestasi) * 100 : 0;
            document.getElementById(ids.persenAkademik).textContent = `${persenAkademik.toFixed(0)}%`;
            
            if (ids.nonAcademic) {
                 const nonAcademicText = data.prestasiNonAkademik.length > 0 ? data.prestasiNonAkademik.join(', ') : '-';
                 document.getElementById(ids.nonAcademic).textContent = nonAcademicText;
            }
        }
        
        // --- Fungsi Analisis Interaktif ---
        function setupAnalysisToggle(containerId, summaryId, promptId, data) {
            const container = document.getElementById(containerId);
            const summaryDiv = document.getElementById(summaryId);
            const prompt = document.getElementById(promptId);

            if (!container || !summaryDiv || !prompt) return;

            container.addEventListener('click', () => {
                if (!data.summaryGenerated) {
                    const modusHobi = data.hobi.reduce((prev, current) => (prev.value > current.value) ? prev : current);
                    const maxAktivitasValue = Math.max(...data.aktivitas.map(item => item.value));
                    const modusAktivitas = data.aktivitas
                        .filter(item => item.value === maxAktivitasValue)
                        .map(item => item.name)
                        .join(', ');

                    const firstAcademic = data.prestasiAkademik[0] || 'prestasi akademis';
                    let achievementText;
                    
                    if(data.prestasiNonAkademik.length > 0) {
                        const firstNonAcademic = data.prestasiNonAkademik[0];
                        achievementText = `Keseimbangan ini tercermin dari prestasinya, baik di bidang akademis seperti <strong>${firstAcademic}</strong>, maupun non-akademis sebagai <strong>${firstNonAcademic}</strong>.`;
                    } else {
                        achievementText = `Fokus utamanya tercermin pada prestasi akademisnya, seperti <strong>${firstAcademic}</strong>.`;
                    }

                    summaryDiv.innerHTML = `
                        <p class="text-sm text-primary font-semibold">Rangkuman Detail:</p>
                        <p class="text-sm mt-2">
                            Dedikasinya pada hobi <strong>${modusHobi.name}</strong> sangat terlihat.
                            Pola aktivitas hariannya sangat terstruktur, dengan <strong>${modusAktivitas}</strong> sebagai kegiatan paling sering dilakukan.
                            ${achievementText}
                        </p>
                    `;
                    data.summaryGenerated = true;
                }
                
                summaryDiv.classList.toggle('show');
                prompt.style.opacity = '0'; // Sembunyikan prompt setelah diklik
            });
        }


        // --- Fungsi Universal untuk Setup Interaktivitas ---
        function setupInteractiveCard(cardId, textId, dataObject) {
            const card = document.getElementById(cardId);
            const text = document.getElementById(textId);
            if (card && text) {
                // Tampilkan prestasi pertama saat memuat
                text.innerHTML = dataObject.prestasiAkademik[0] || 'Data tidak tersedia';

                card.addEventListener('click', (e) => {
                    e.stopPropagation(); // Hentikan event agar tidak trigger analisis
                    if (dataObject.prestasiAkademik.length > 0) {
                        dataObject.prestasiIndex = (dataObject.prestasiIndex + 1) % dataObject.prestasiAkademik.length;
                        text.classList.remove('text-flipping');
                        void text.offsetWidth; // Trigger reflow
                        text.classList.add('text-flipping');
                        text.innerHTML = dataObject.prestasiAkademik[dataObject.prestasiIndex];
                    }
                });
            }
        }

        // --- Fungsi Grafik & Tabel ---
        function createPieChart(data, chartElementId, legendElementId) { 
            const chartDiv = document.querySelector(chartElementId);
            if (!chartDiv) return;
            chartDiv.innerHTML = ""; 
            const w=250, h=250, m=20, r=Math.min(w,h)/2-m; 
            const svg=d3.select(chartElementId).append("svg")
                .attr("width",w).attr("height",h)
                .append("g").attr("transform",`translate(${w/2},${h/2})`); 
            
            const total = d3.sum(data, d => d.value);

            const color=d3.scaleOrdinal().domain(data.map(d=>d.name)).range(["#6366f1","#ec4899","#10b981", "#f59e0b", "#3b82f6"]); 
            const pie=d3.pie().value(d=>d.value).sort(null); 
            const arc=d3.arc().innerRadius(r * 0.5).outerRadius(r); 
            const hArc=d3.arc().innerRadius(r * 0.5).outerRadius(r + 10); 
            const arcs=svg.selectAll(".arc").data(pie(data)).enter().append("g").attr("class","arc"); 
            
            arcs.append("path").attr("fill",d=>color(d.data.name))
                .style("stroke","#111827")
                .style("stroke-width","3px")
                .style("transition", "opacity 0.3s ease")
                .each(function(d) { this._current = d; })
                .transition().duration(1000)
                .attrTween("d", function(d) {
                    const i = d3.interpolate(this._current, d);
                    this._current = i(0);
                    return function(t) { return arc(i(t)); };
                });

            // --- TAMBAHKAN TEKS PERSENTASE PADA PIE SLICE ---
            arcs.append("text")
                .attr("transform", d => `translate(${arc.centroid(d)})`)
                .attr("dy", ".35em")
                .style("text-anchor", "middle")
                .style("fill", "#f3f4f6")
                .style("font-size", "11px")
                .style("font-weight", "600")
                .style("pointer-events", "none") // Agar tidak mengganggu mouse event
                .style("opacity", 0)
                .text(d => {
                    const percentage = (d.data.value / total) * 100;
                    // Hanya tampilkan jika persentase cukup besar
                    if (percentage < 7) return ""; 
                    return `${percentage.toFixed(0)}%`;
                })
                .transition()
                .duration(800)
                .delay(1200) // Tampil setelah animasi pie selesai
                .style("opacity", 1);


            arcs.append("title").text(d=>`${d.data.name}: ${d.data.value}`); 
            
            const centerText = svg.append("text").attr("text-anchor", "middle").attr("dy", "0.35em").style("fill", "var(--text-primary)").style("font-size", "1.5rem").style("font-weight", "bold").style("opacity", 0).text(total);
            const centerSubText = svg.append("text").attr("text-anchor", "middle").attr("dy", "1.5em").style("fill", "var(--text-secondary)").style("font-size", "0.9rem").style("opacity", 0).text("Total");

            setTimeout(() => {
                centerText.transition().duration(500).style("opacity", 1);
                centerSubText.transition().duration(500).style("opacity", 1);
            }, 1000);
            
            arcs.on("mouseover",function(e,d){
                d3.select(this).select("path").transition().duration(200).attr("d",hArc);
                svg.selectAll(".arc path").style("opacity", p => p.data.name === d.data.name ? 1 : 0.5);
                centerText.text(d.data.value); // Tampilkan frekuensi saat hover
                centerSubText.text(d.data.name); // Tampilkan nama hobi di bawah
            }).on("mouseout",function(e,d){
                d3.select(this).select("path").transition().duration(200).attr("d",arc);
                svg.selectAll(".arc path").style("opacity", 1);
                centerText.text(total);
                centerSubText.text("Total");
            });
            
            const legend = d3.select(legendElementId);
            if (!legend.node()) return;
            legend.html(""); 
            const legendItems = legend.selectAll(".legend-item").data(data).enter().append("div").attr("class", "legend-item");
            legendItems.append("span").attr("class", "legend-color-dot").style("background-color", d => color(d.name));
            // --- UBAH LEGENDA UNTUK MENUNJUKKAN PERSENTASE ---
            legendItems.append("span").text(d => {
                const percentage = (d.value / total) * 100;
                return `${d.name} (${percentage.toFixed(1)}%)`;
            });
        }
        
        function createScoreBarChart(data, chartElementId) {
            const chartDiv = document.querySelector(chartElementId);
            if (!chartDiv) return;
            chartDiv.innerHTML = "";
            const m = { top: 30, right: 20, bottom: 60, left: 40 },
                w = 300 - m.left - m.right,
                h = 250 - m.top - m.bottom;

            const svg = d3.select(chartElementId).append("svg")
                .attr("width", w + m.left + m.right)
                .attr("height", h + m.top + m.bottom)
                .append("g")
                .attr("transform", `translate(${m.left},${m.top})`);

            const color = d3.scaleOrdinal()
                .domain(data.map(d => d.name))
                .range(["#6366f1", "#ec4899", "#10b981", "#f59e0b", "#3b82f6", "#ef4444", "#8b5cf6"]);

            const x = d3.scaleBand()
                .range([0, w])
                .domain(data.map(d => d.name))
                .padding(0.2);

            const y = d3.scaleLinear()
                .range([h, 0])
                .domain([0, 100]); // Sumbu Y dari 0 sampai 100

            svg.append("g")
                .attr("transform", `translate(0,${h})`)
                .call(d3.axisBottom(x))
                .selectAll("text")
                .style("fill", "var(--text-secondary)")
                .attr("transform", "translate(-10,0)rotate(-45)")
                .style("text-anchor", "end");

            svg.append("g")
                .call(d3.axisLeft(y).ticks(5))
                .selectAll("text")
                .style("fill", "var(--text-secondary)");

            svg.selectAll(".domain,.tick line").style("stroke", "var(--border-color)");

            const bars = svg.selectAll(".bar")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => x(d.name))
                .attr("y", y(0))
                .attr("width", x.bandwidth())
                .attr("height", 0)
                .attr("fill", d => color(d.name))
                .on("mouseover", function(e, d) {
                    d3.select(this)
                        .style("filter", "brightness(1.2)")
                        .transition().duration(200)
                        .attr('y', y(d.value) - 10) // Pindahkan ke atas
                        .attr('height', h - y(d.value) + 10); // Tambah tinggi
                    
                    svg.append("text")
                       .attr("class", "bar-label")
                       .attr("x", x(d.name) + x.bandwidth() / 2)
                       .attr("y", y(d.value) - 15) // Sesuaikan posisi y label
                       .attr("text-anchor", "middle")
                       .style("fill", "var(--text-primary)")
                       .style("font-size", "0.9rem")
                       .style("font-weight", "600")
                       .style("opacity", 0)
                       .text(d.value)
                       .transition().duration(200)
                       .style("opacity", 1);
                })
                .on("mouseout", function(e, d) {
                    d3.select(this)
                        .style("filter", "brightness(1)")
                        .transition().duration(200)
                        .attr('y', y(d.value)) // Kembali ke y semula
                        .attr('height', h - y(d.value)); // Kembali ke tinggi semula

                         svg.selectAll(".bar-label").transition().duration(200).style("opacity", 0).remove();
                });

            bars.transition().duration(1200).ease(d3.easeBounceOut).delay((d, i) => i * 100)
                .attr("y", d => y(d.value))
                .attr("height", d => h - y(d.value));

            bars.append("title").text(d => `${d.name}: ${d.value}`);
        }

        // --- DIAGRAM BARU: RADIAL BAR CHART ---
        function createRadialBarChart(data, elementId, legendElementId) {
            const chartDiv = document.querySelector(elementId);
            if (!chartDiv) return;
            chartDiv.innerHTML = "";

            const margin = {top: 10, right: 10, bottom: 10, left: 10},
                  width = 300 - margin.left - margin.right,
                  height = 250 - margin.top - margin.bottom,
                  innerRadius = 50,
                  outerRadius = Math.min(width, height) / 2;

            const svg = d3.select(elementId)
              .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
              .append("g")
                .attr("transform", `translate(${width/2 + margin.left}, ${height/2 + margin.top})`);

            const color = d3.scaleOrdinal()
                .domain(data.map(d => d.name))
                .range(["#6366f1", "#ec4899", "#10b981", "#f59e0b", "#3b82f6", "#ef4444", "#8b5cf6"]);

            const x = d3.scaleBand()
                .range([0, 2 * Math.PI])
                .align(0)
                .domain(data.map(d => d.name));

            const y = d3.scaleRadial()
                .range([innerRadius, outerRadius])
                .domain([0, d3.max(data, d => d.value) * 1.1]);
            
            const total = d3.sum(data, d => d.value);

            const centerValue = svg.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", "-0.2em")
                .style("fill", "var(--text-primary)")
                .style("font-size", "2rem")
                .style("font-weight", "700");
                
            const centerLabel = svg.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", "1.2em")
                .style("fill", "var(--text-secondary)")
                .style("font-size", "0.9rem")
                .style("text-transform", "capitalize");

            const initialArc = d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(innerRadius) // Mulai dari dalam
                .startAngle(d => x(d.name))
                .endAngle(d => x(d.name) + x.bandwidth())
                .padAngle(0.01)
                .padRadius(innerRadius);
                
            const finalArc = d => d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(y(d.value))
                .startAngle(x(d.name))
                .endAngle(x(d.name) + x.bandwidth())
                .padAngle(0.01)
                .padRadius(innerRadius)(d);

            const bars = svg.append("g")
                .selectAll("path")
                .data(data)
                .join("path")
                .attr("fill", d => color(d.name))
                .attr("d", initialArc);

            // Animation
            bars.transition()
                .duration(1200)
                .delay((d,i) => i * 100)
                .ease(d3.easeBounceOut) // <-- EFEK BARU: MEMANTUL
                .attr("d", finalArc);
            
            // --- TAMBAHKAN PERSENTASE DI DALAM RADIAL BAR ---
            const labels = svg.append("g")
                .selectAll("text")
                .data(data)
                .join("text")
                .attr("text-anchor", "middle")
                .attr("dy", "0.35em")
                .style("fill", "#f3f4f6")
                .style("font-size", "10px")
                .style("font-weight", "600")
                .style("pointer-events", "none")
                .style("opacity", 0);

            // Tampilkan label setelah animasi bar selesai
            setTimeout(() => {
                labels
                    .attr("transform", d => {
                        // Kalkulasi manual untuk posisi tengah yang lebih akurat
                        const midAngle = x(d.name) + x.bandwidth() / 2;
                        const midRadius = (innerRadius + y(d.value)) / 2;
                        
                        // Konversi dari koordinat polar ke cartesian untuk penempatan teks
                        // sin(angle) untuk x dan -cos(angle) untuk y karena D3 memulai sudut dari atas (jam 12)
                        const cx = midRadius * Math.sin(midAngle);
                        const cy = -midRadius * Math.cos(midAngle);
                        
                        return `translate(${cx}, ${cy})`;
                    })
                    .text(d => {
                        const percentage = (d.value / total) * 100;
                        // Sembunyikan jika segmen terlalu kecil untuk menghindari tumpang tindih
                        const midRadiusForCheck = (innerRadius + y(d.value)) / 2; // FIX: Definisikan lagi di sini
                        const arcLengthInPixels = x.bandwidth() * midRadiusForCheck;
                        if (arcLengthInPixels < 20) return ""; 
                        return `${percentage.toFixed(0)}%`;
                    })
                    .transition().duration(500).style("opacity", 1);
            }, 1300);


            // Hover effects
            bars.on("mouseover", function(event, d) {
                d3.select(this)
                    .transition()
                    .duration(250)
                    .ease(d3.easeCubicOut)
                    .attr("fill", d3.color(color(d.name)).brighter(0.7))
                    .attr("d", d3.arc() // <-- EFEK BARU: MENGANGKAT/MEMBESAR
                        .innerRadius(innerRadius)
                        .outerRadius(y(d.value) + 10) 
                        .startAngle(x(d.name))
                        .endAngle(x(d.name) + x.bandwidth())
                        .padAngle(0.01)
                        .padRadius(innerRadius)
                    );
                centerValue.text(d.value);
                centerLabel.text(d.name);
                labels.transition().duration(100).style("opacity", 0); // Sembunyikan semua label
            }).on("mouseout", function(event, d) {
                d3.select(this)
                    .transition()
                    .duration(250)
                    .ease(d3.easeCubicOut)
                    .attr("fill", color(d.name))
                    .attr("d", finalArc); // Kembali ke ukuran semula
                centerValue.text("");
                centerLabel.text("");
                labels.transition().delay(150).duration(100).style("opacity", 1); // Tampilkan lagi
            });
            
            bars.append("title").text(d => `${d.name}: ${d.value} kali`);
            
             // --- PEMBUATAN LEGENDA ---
            const legendContainer = d3.select(legendElementId);
            if (legendContainer.node()){
                legendContainer.html("");

                const legendItems = legendContainer.selectAll(".legend-item")
                    .data(data)
                    .enter()
                    .append("div")
                    .attr("class", "legend-item");

                legendItems.append("span")
                    .attr("class", "legend-color-dot")
                    .style("background-color", d => color(d.name));

                legendItems.append("span")
                    .text(d => {
                        const percentage = (d.value / total) * 100;
                        return `${d.name} (${percentage.toFixed(1)}%)`;
                    });
            }
        }


        function createTable(data, elementId) {
            const tbody = document.getElementById(elementId);
            if (!tbody) return;
            tbody.innerHTML = '';
            data.forEach((item, index) => {
                const row = document.createElement('tr');
                row.style.opacity = '0';
                row.style.animation = `slideUpFadeIn 0.5s ease-out ${index * 0.15 + 0.2}s forwards`;
                row.innerHTML = `<td>${item.name}</td><td>${item.value} kali</td>`;
                tbody.appendChild(row);
            });
        }

        // --- Panggil semua fungsi setelah dokumen selesai dimuat ---
        document.addEventListener('DOMContentLoaded', () => {
            // Setup Ahmad
            createTable(dataAhmad.hobi, "hobi-table-ahmad");
            createTable(dataAhmad.aktivitas, "aktivitas-table-ahmad");
            createPieChart(dataAhmad.hobi, "#pie-chart-ahmad", "#pie-legend-ahmad");
            createRadialBarChart(dataAhmad.aktivitas, "#bar-chart-ahmad", "#bar-legend-ahmad");
            createScoreBarChart(dataAhmad.nilaiAkademik, "#prestasi-chart-ahmad");
            setupInteractiveCard('academic-card-ahmad', 'academic-achievement-ahmad', dataAhmad);
            calculateAndDisplayStats(dataAhmad, {
                avgAktivitas: 'avg-aktivitas-ahmad', 
                modusHobi: 'modus-hobi-ahmad', 
                persenAkademik: 'persen-akademik-ahmad',
                nonAcademic: 'non-academic-achievement-ahmad'
            });
            setupAnalysisToggle('analysis-container-ahmad', 'summary-ahmad', 'prompt-ahmad', dataAhmad);

            // Setup Dawi
            createTable(dataDawi.hobi, "hobi-table-dawi");
            createTable(dataDawi.aktivitas, "aktivitas-table-dawi");
            createPieChart(dataDawi.hobi, "#pie-chart-dawi", "#pie-legend-dawi");
            createRadialBarChart(dataDawi.aktivitas, "#bar-chart-dawi", "#bar-legend-dawi");
            createScoreBarChart(dataDawi.nilaiAkademik, "#prestasi-chart-dawi");
            setupInteractiveCard('academic-card-dawi', 'academic-achievement-dawi', dataDawi);
            calculateAndDisplayStats(dataDawi, {
                avgAktivitas: 'avg-aktivitas-dawi', 
                modusHobi: 'modus-hobi-dawi', 
                persenAkademik: 'persen-akademik-dawi',
                nonAcademic: 'non-academic-achievement-dawi'
            });
            setupAnalysisToggle('analysis-container-dawi', 'summary-dawi', 'prompt-dawi', dataDawi);
            
            // Setup Fasa
            createTable(dataFasa.hobi, "hobi-table-fasa");
            createTable(dataFasa.aktivitas, "aktivitas-table-fasa");
            createPieChart(dataFasa.hobi, "#pie-chart-fasa", "#pie-legend-fasa");
            createRadialBarChart(dataFasa.aktivitas, "#bar-chart-fasa", "#bar-legend-fasa");
            createScoreBarChart(dataFasa.nilaiAkademik, "#prestasi-chart-fasa");
            setupInteractiveCard('academic-card-fasa', 'academic-achievement-fasa', dataFasa);
            calculateAndDisplayStats(dataFasa, {
                avgAktivitas: 'avg-aktivitas-fasa', 
                modusHobi: 'modus-hobi-fasa', 
                persenAkademik: 'persen-akademik-fasa',
                nonAcademic: 'non-academic-achievement-fasa'
            });
            setupAnalysisToggle('analysis-container-fasa', 'summary-fasa', 'prompt-fasa', dataFasa);
            
             document.querySelectorAll('.tab-btn').forEach(button => {
                 button.addEventListener('click', (event) => {
                     const pageId = event.target.getAttribute('onclick').match(/'([^']+)'/)[1];
                     showPage(pageId);
                 });
             });
        });
    </script>
</body>
</html>
